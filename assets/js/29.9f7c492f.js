(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{305:function(s,a,t){"use strict";t.r(a);var n=t(14),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" DockerFile")]),s._v(" "),a("h2",{attrs:{id:"dockerfile自动构建docker镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile自动构建docker镜像"}},[s._v("#")]),s._v(" Dockerfile自动构建docker镜像")]),s._v(" "),a("p",[s._v("官方构建dockerffile文件参考:https://github.com/CentOS/CentOS-Dockerfiles")]),s._v(" "),a("h3",{attrs:{id:"dockerfile指令集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile指令集"}},[s._v("#")]),s._v(" Dockerfile指令集")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v(" 基础镜像信息 "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FROM")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("centos")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.8")]),s._v("\n\n 制作镜像操作指令"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUN")]),s._v(" yum insatll openssh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("server \\"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y\n\n 容器启动时执行指令 "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMD")]),s._v(" \\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("\\"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FROM")]),s._v(" 这个镜像的妈妈是谁？（指定基础镜像）\n\n "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MAINTAINER")]),s._v(" 告诉别人，谁负责养它？（指定维护者信息，可以没有）\n\n "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUN")]),s._v(" 你想让它干啥（在命令前面加上"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUN")]),s._v("即可）\n\n "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ADD")]),s._v(" 给它点创业资金（"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("COPY")]),s._v("文件，会自动解压）\n\n "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WORKDIR")]),s._v(" 我是cd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("今天刚化了妆（设置当前工作目录）\n\n "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("VOLUME")]),s._v(" 给它一个存放行李的地方（设置卷，挂载主机目录）\n\n "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXPOSE")]),s._v(" 它要打开的门是啥（指定对外的端口）\n\n "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMD")]),s._v(" 奔跑吧，兄弟！（指定容器启动后的要干的事情）\n \n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("COPY")]),s._v(" 复制文件\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ENV")]),s._v("  环境变量\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ENTRYPOINT")]),s._v("  容器启动后执行的命令\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h3",{attrs:{id:"创建一个dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建一个dockerfile"}},[s._v("#")]),s._v(" 创建一个Dockerfile")]),s._v(" "),a("p",[s._v("创建第一个Dockerfile文件")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("# 创建目录\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker01 base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# cd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("base\n# 创建Dcokerfile文件，注意大小写\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker01 base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# vim Dockerfile\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FROM")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("centos")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.8")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUN")]),s._v(" yum install openssh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("server "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y \n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUN")]),s._v(" echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root:123456"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("chpasswd\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sshd start \n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMD")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/sbin/sshd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-D"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("构建docker镜像")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker01 base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# docker image build  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("t centos6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ssh "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("t 为镜像标签打标签  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" 表示当前路径\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);