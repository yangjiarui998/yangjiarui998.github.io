<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | 杨家瑞的博客</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="...">
    
    <link rel="preload" href="/assets/css/0.styles.8c9c6a10.css" as="style"><link rel="preload" href="/assets/js/app.a039a66c.js" as="script"><link rel="preload" href="/assets/js/2.c45f6c53.js" as="script"><link rel="preload" href="/assets/js/1.6a3528a3.js" as="script"><link rel="preload" href="/assets/js/28.6714cb4d.js" as="script"><link rel="prefetch" href="/assets/js/10.b30099e9.js"><link rel="prefetch" href="/assets/js/11.deaa8860.js"><link rel="prefetch" href="/assets/js/12.315bb3dc.js"><link rel="prefetch" href="/assets/js/13.038a48b5.js"><link rel="prefetch" href="/assets/js/14.33b87d48.js"><link rel="prefetch" href="/assets/js/15.0a5e13e6.js"><link rel="prefetch" href="/assets/js/16.374a57a0.js"><link rel="prefetch" href="/assets/js/17.85055749.js"><link rel="prefetch" href="/assets/js/18.7efbad74.js"><link rel="prefetch" href="/assets/js/19.a45744ea.js"><link rel="prefetch" href="/assets/js/20.c22d9498.js"><link rel="prefetch" href="/assets/js/21.9fb7922e.js"><link rel="prefetch" href="/assets/js/22.227169e2.js"><link rel="prefetch" href="/assets/js/23.db8c7cfc.js"><link rel="prefetch" href="/assets/js/24.c9e88d5f.js"><link rel="prefetch" href="/assets/js/25.84d4bf90.js"><link rel="prefetch" href="/assets/js/26.23199df2.js"><link rel="prefetch" href="/assets/js/27.dea3a96a.js"><link rel="prefetch" href="/assets/js/29.1d641fc6.js"><link rel="prefetch" href="/assets/js/3.893caba0.js"><link rel="prefetch" href="/assets/js/30.188b5643.js"><link rel="prefetch" href="/assets/js/31.64506bda.js"><link rel="prefetch" href="/assets/js/4.184df7a2.js"><link rel="prefetch" href="/assets/js/5.11f3c199.js"><link rel="prefetch" href="/assets/js/6.072a7d47.js"><link rel="prefetch" href="/assets/js/7.c5640ac7.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.e709020c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8c9c6a10.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="杨家瑞的博客" class="logo"> <span class="site-name can-hide">杨家瑞的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="杨家瑞的博客" class="dropdown-title"><span class="title">杨家瑞的博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="杨家瑞的博客" class="mobile-dropdown-title"><span class="title">杨家瑞的博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/yangjiaruiaa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="杨家瑞的博客" class="dropdown-title"><span class="title">杨家瑞的博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="杨家瑞的博客" class="mobile-dropdown-title"><span class="title">杨家瑞的博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/yangjiaruiaa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/book/Nodejs 安装" class="sidebar-heading clickable"><span>环境搭建</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/book/Dotnet基础" class="sidebar-heading clickable"><span>.NET</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/book/VMware Centos7" class="sidebar-heading clickable"><span>Liunx学习</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/book/Docker" class="sidebar-heading clickable open active"><span>Docker</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/book/Docker.html" aria-current="page" class="active sidebar-link">Docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/book/Docker.html#docker简介" class="sidebar-link">Docker简介</a></li><li class="sidebar-sub-header"><a href="/book/Docker.html#docker安装" class="sidebar-link">Docker安装</a></li><li class="sidebar-sub-header"><a href="/book/Docker.html#docker卸载" class="sidebar-link">Docker卸载</a></li><li class="sidebar-sub-header"><a href="/book/Docker.html#docker部署-net" class="sidebar-link">Docker部署.NET</a></li><li class="sidebar-sub-header"><a href="/book/Docker.html#docker常用命令" class="sidebar-link">Docker常用命令</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MicroService</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h1> <h2 id="docker简介"><a href="#docker简介" class="header-anchor">#</a> Docker简介</h2> <p><strong>为什么出现？</strong></p> <p>当实际生产环境需要有多个不同版本的环境时如果使用虚拟机将大大浪费资源</p> <p>docker 容器可以做到每个版本都打包为一个容器镜像 然后在同一个主机上运行 每个容器都可以用于自己的依赖项和运行环境不会互相干扰</p> <p><strong>介绍</strong></p> <p>Docker的核心思想就是来自集装箱；集装箱的概念是隔离货物，所以docker的核心就是隔离机制。同时docker使用可移植镜像所以部署以及运维极其方便快捷。</p> <p>Docker 是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的<a href="http://baike.baidu.com/view/1634.htm" target="_blank" rel="noopener noreferrer">Linux<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>机器上，也可以实现虚拟化。</p> <p>容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）。几乎没有性能开销,可以很容易地在机器和数据中心中运行。最重要的是,他们不依赖于任何语言、框架或包括系统。</p> <p>下面对比了Docker 和传统虚拟化（KVM、XEN等）方式的不同之处，容器是在操作系统层面上实现虚拟化，直接复用本地主机的操作系统，而传统方式则是在硬件的基础上，虚拟出自己的系统，再在系统上部署相关的APP应用。</p> <p>Docker虚拟化有三个概念需要理解，分别镜像、容器、仓库。</p> <p><strong>镜像（image）：</strong></p> <p>docker的镜像其实就是模板，跟我们常见的ISO镜像类似，是一个样板。通过这个镜像可以创建多个容器（最终服务运行或者项目运行就是在容器中的）。</p> <p><strong>容器（container）：</strong>
Docker利用容器技术，独立运行一个或者一个组应用，通过镜像来创建的。
启动，停止，删除，基本命令！
目前就可以把这个容器理解为就是一个简易的linux系统</p> <p><strong>仓库（repository）：</strong>
仓库就是存放镜像的地方！
分为公开仓库（Public）和私有仓库（Private）两种形式。</p> <h2 id="docker安装"><a href="#docker安装" class="header-anchor">#</a> Docker安装</h2> <ol><li><p><strong>查看系统内核 3.10版本可用docker</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>uname -r
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><strong>使用 root 权限更新 yum 包（生产环境中此步操作需慎重，看自己情况，学习的话随便搞）</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token parameter variable">-y</span> update

注意​ 
yum <span class="token parameter variable">-y</span> update：升级所有包同时也升级软件和系统内核；​ 
yum <span class="token parameter variable">-y</span> upgrade：只升级所有包，不升级软件和系统内核
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><strong>卸载旧版本（如果之前安装过的话）</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum remove <span class="token function">docker</span>  docker-common docker-selinux docker-engine
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><strong>安装需要的软件包， yum-util 提供yum-config-manager功能，另两个是devicemapper驱动依赖</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token function">install</span> <span class="token parameter variable">-y</span> yum-utils device-mapper-persistent-data lvm2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><strong>设置 yum 源</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum-config-manager --add-repo http://download.docker.com/linux/centos/docker-ce.repo（中央仓库）

yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo（阿里仓库）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p><strong>选择docker版本并安装</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum list docker-ce <span class="token parameter variable">--showduplicates</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-r</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><strong>选择一个版本并安装</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token parameter variable">-y</span> <span class="token function">install</span> docker-ce-18.03.1.ce
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><strong>启动 Docker 并设置开机自启</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>systemctl start <span class="token function">docker</span>
systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol> <h2 id="docker卸载"><a href="#docker卸载" class="header-anchor">#</a> Docker卸载</h2> <p>1.<strong>卸载命令</strong></p> <blockquote><div class="language- line-numbers-mode"><pre class="language-text"><code>yum remove docker*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <p>2.<strong>查看不存在则卸载成功</strong></p> <blockquote><div class="language- line-numbers-mode"><pre class="language-text"><code>$ yum list installed|grep docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <p>3.<strong>删除docker相关文件</strong></p> <blockquote><div class="language- line-numbers-mode"><pre class="language-text"><code>$ rm -rf /var/lib/docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <h3 id="docker卸载解决问题"><a href="#docker卸载解决问题" class="header-anchor">#</a> Docker卸载解决问题</h3> <p>yum remove命令出现</p> <p><code>Loaded plugins: fastestmirror</code> <code>fastestmirror</code>是yum的一个加速插件，这里是插件提示信息是插件不能用了</p> <p><strong>解决步骤</strong>：
1.修改插件的配置文件  将enabled=1改为enabled=0</p> <blockquote><div class="language- line-numbers-mode"><pre class="language-text"><code>$ vi /etc/yum/pluginconf.d/fastestmirror.conf 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <p>2.修改yum的配置文件  将plugins=1改为plugins=0</p> <blockquote><div class="language- line-numbers-mode"><pre class="language-text"><code>$ vi /etc/yum.conf 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <p>3.清除缓存并重新构建yum源</p> <blockquote><div class="language- line-numbers-mode"><pre class="language-text"><code>yum clean all
rm -rf /var/cache/yum
yum makecache
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></blockquote> <h2 id="docker部署-net"><a href="#docker部署-net" class="header-anchor">#</a> Docker部署.NET</h2> <p><strong>DockerFile</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>FROM mcr.microsoft.com/dotnet/aspnet:6.0 AS base
WORKDIR /app
EXPOSE 81

FROM base AS final
# 从当前文件目录，复制文件到docker目录
COPY . . 
ENTRYPOINT [&quot;dotnet&quot;, &quot;Look.dll&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>把程序发布到文件夹cp到指定文件夹下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>1.拉取.net6镜像
docker pull mcr.microsoft.com/dotnet/aspnet:6.0
2.进入发布程序文件夹下构造镜像
cd projects/
docker build -t look .  #look是镜像名称
3.创建容器格式：
docker run -d --name  容器名  -p  外部端口号:docker容器端口号  --restart=always  -v  /宿主机目录 : /容器目录  镜像名

docker run -d --name look -p 5001:81  look

-d　　　　               #后台运行

-p 8001:80　　　　#缩主机端口号 : docker端口号

-v　　　　              #数据卷路径，格式：（-v  /宿主机目录 : 容器目录）或者（-v  /容器目录），可以带多个 -v 参数。

--restart=always     #dokcer重新启动时也将容器自动启动
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="docker常用命令"><a href="#docker常用命令" class="header-anchor">#</a> Docker常用命令</h2> <table><thead><tr><th style="text-align:left;">命令</th> <th style="text-align:left;">说明</th></tr></thead> <tbody><tr><td style="text-align:left;">docker images</td> <td style="text-align:left;">查看镜像列表</td></tr> <tr><td style="text-align:left;">docker search ubuntu</td> <td style="text-align:left;">镜像搜索（比如搜索 ubuntu 基础镜像）</td></tr> <tr><td style="text-align:left;">docker pull           镜像名</td> <td style="text-align:left;">下拉镜像</td></tr> <tr><td style="text-align:left;">docker save        镜像名/镜像ID -o 镜像保存在哪个位置与名字</td> <td style="text-align:left;">保存镜像</td></tr> <tr><td style="text-align:left;">docker rmi -f         镜像名/镜像ID</td> <td style="text-align:left;">删除镜像</td></tr> <tr><td style="text-align:left;">docker ps -a</td> <td style="text-align:left;">查看所有容器 -----包含正在运行 和已停止的*</td></tr> <tr><td style="text-align:left;">docker stop          容器名/容器ID</td> <td style="text-align:left;">停止容器</td></tr> <tr><td style="text-align:left;">docker start        容器名/容器ID</td> <td style="text-align:left;">开启容器</td></tr> <tr><td style="text-align:left;">docker rm -f          容器名/容器ID</td> <td style="text-align:left;">删除一个容器</td></tr> <tr><td style="text-align:left;">docker rm -f         容器名/容器ID 容器名/容器ID 容器名/容器ID</td> <td style="text-align:left;"><em>删除多个容器 空格隔开要删除的容器名或容器ID</em></td></tr> <tr><td style="text-align:left;">docker rm -f $(docker ps -aq)</td> <td style="text-align:left;"><em>删除全部容器</em></td></tr> <tr><td style="text-align:left;">docker logs 镜像名</td> <td style="text-align:left;">查看日志</td></tr> <tr><td style="text-align:left;">docker  exec  -it  id  /bin/bash</td> <td style="text-align:left;">进入容器文件</td></tr> <tr><td style="text-align:left;">service docker start</td> <td style="text-align:left;">重启docker</td></tr> <tr><td style="text-align:left;">systemctl enable docker</td> <td style="text-align:left;">开机自动启docker</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/book/VMware Centos7.html" class="prev">
        VMware
      </a></span> <span class="next"><a href="/book/1.1微服务项目搭建.html">
        微服务项目搭建
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a039a66c.js" defer></script><script src="/assets/js/2.c45f6c53.js" defer></script><script src="/assets/js/1.6a3528a3.js" defer></script><script src="/assets/js/28.6714cb4d.js" defer></script>
  </body>
</html>
